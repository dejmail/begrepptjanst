{% extends 'base-front.html' %}
{% load static %}
{% spaceless %}

{% block header_row2 %}
<div class="row">

</div>
{% endblock header_row2 %}


{% block body_left_column %}
  {% include 'left-sidebar.html' %}
{% endblock body_left_column %}

{% block body_middle_column %}

{{block.super}}
{% if queryset %}

{% load get_item %}
{% load extract_attribute %}
{% load config_filter %}

{% config_filter queryset=config attribute="title" attribute_value="tag_view" as tag_view %}                    

<div class="col-lg-8 col-md-8 mt-4" id="search-row-middle-column">

  
    <div class="container">
      <div class="row">
      <div class="col-12">

        <table class="table table-bordered top-buffer-10" id="definition_table">
          <colgroup>
            {% if tag_view.is_active %}
            <col class="col-3">
            <col class="col-2">
            <col class="col-5">
            <col class="col-2">
              
            {% else %}
            <col class="col-4">
            <col class="col-2">
            <col class="col-6">              
            {% endif %}
          </colgroup>
            <thead>
              <tr>
                <th>Rekommenderad term</th>
                <th>Synonym</th>
                <th>Definition</th>
                {% if tag_view.is_active %}
                  <th>Tag</th>
                {% endif %}
              </tr>
            </thead>
            <tbody id="myTable">
              {% for term in page_obj %}            
                <tr class="{{ färg_status|get_item:term.status }} border-radius-10">
                  <td><a href="{% url 'begrepp_förklaring' %}?search_term={{term.id}}" id={{term.id}}>{{term.term}}</a></td>
                  <td>
                    
                    {% for item in queryset %}
                    
                        {% if item.id == term.id %}
                          {% for term_with_relation in related_terms.all %}
                            {% if term_with_relation.base_term.id == term.id %}
                              {% if term_with_relation.child_term.status == "Avråds" %}
                                <div class="tooltip">  - <s class="text-danger">{{term_with_relation.child_term.term}}</s>
                                    <span class="tooltiptext" style="background-color: red;">
                                        <div>Relation : {{term_with_relation.relationship}}</div>
                                        <div>Status : {{term_with_relation.child_term.status}}</div>
                                    </span>
                                </div>
                                <br>
                              {% else %}
                                  <div class="tooltip">- {{term_with_relation.child_term.term}}
                                      <span class="tooltiptext">
                                        <div>Relation : {{term_with_relation.relationship}}</div>
                                        <div>Status : {{term_with_relation.child_term.status}}</div>
                                  </div>
                                  <br>
                              {% endif %} 
                            {% endif %} 
                        {% endfor %}
                      {% endif %}
                    {% endfor queryset %}
                </td>
                <td>{{term.definition}}</td>


                {% if tag_view.is_active %}
                  <td>
                    {% extract_attribute target_id=term.id queryset=queryset attribute="dictionaries" as dictionaries %}
                    {% if dictionaries %}
                        {% for dictionary in dictionaries.all %}
                        {% if not forloop.last %}
                          {{dictionary.title}},
                        {% else %}
                          {{dictionary.title}}
                        {% endif %}
                        
                        {% endfor %}
                    {% endif %}
                </td>

                {% else %}

                {% endif %}
                </tr>
                
              {% endfor page_obj %}
            </tbody>
          </table>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-12 pagination">
        <!-- Pagination links -->
        <!-- Add the following onclick event handlers to show the spinner when pagination links are clicked -->
        <div class="row">
            <div class="col-12 text-center">
                <div class="pagination-links">
                    <a href="?search_term={{searched_for_term|urlencode}}&dictionaries={{selected_dictionaries|join:''}}&display_all=true" title="Visa alla resultat" onclick="showLoadingIndicator()">alla</a>
                </div>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-12 text-center my-3">
              <svg stroke="black" width="5" height="30" class="ms-1 me-1">
                <line x1="2" y1="0" x2="2" y2="30"></line>
              </svg>
            </div>
        </div>
        <div class="row">
            <div class="col-12 text-center">
                <div class="pagination-links">
                    {% if page_obj.has_previous %}
                        <!-- Add onclick event handler to show spinner when pagination links are clicked -->
                        <a href="?search_term={{searched_for_term|urlencode}}&dictionaries={{selected_dictionaries|join:''}}&page=1" title="Första sida av resultater" onclick="showLoadingIndicator()">&laquo; först</a>
                        <a href="?search_term={{searched_for_term|urlencode}}&dictionaries={{selected_dictionaries|join:''}}&page={{ page_obj.previous_page_number }}" title="Föregående 10 resultater" onclick="showLoadingIndicator()">förra</a>
                    {% endif %}
                    <span class="current">
                        Sida {{ page_obj.number }} av {{ page_obj.paginator.num_pages }}.
                    </span>
                    {% if page_obj.has_next %}
                        <!-- Add onclick event handler to show spinner when pagination links are clicked -->
                        <a href="?search_term={{searched_for_term|urlencode}}&dictionaries={{selected_dictionaries|join:''}}&page={{ page_obj.next_page_number }}" title="Nästa 10 resultater" onclick="showLoadingIndicator()">nästa</a>
                        <a href="?search_term={{searched_for_term|urlencode}}&dictionaries={{selected_dictionaries|join:''}}&page={{ page_obj.paginator.num_pages }}" title="Sista sida av resultater" onclick="showLoadingIndicator()">sista &raquo;</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>



</div>
{% else %}  

      <div class="col-lg-9 col-md-9" id="search-row-middle-column">
        <div class="col-12" id="search-row-middle-column">
          <div class="row mt-5">
              <div class="col-1"></div>
              <div class="col-10">
                  {% include 'request-term.html' %}
              </div>
              <div class="col-1"></div>
          </div>
          </div>
      </div>
</div>
{% endif %}
{% endblock body_middle_column %}

{% block body_right_column %}
  {% include 'right-sidebar.html' %}
{% endblock body_right_column %}

{% endspaceless %}
{% block extra_javascript %}

  <style>
    /* Ensure we see intended spacing in the Definitions column */
  tbody > tr > td:nth-child(3) {
    white-space: pre-line;
    }


  </style>


<script>

  $(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
    $("#colour_panel").removeClass('d-none');
    $("#colour_meaning").click(function(){
        $("#colour_panel").toggle();
        });
  });

</script>


{% endblock extra_javascript %}

